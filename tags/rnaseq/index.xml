<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Rnaseq on Ben Kellman</title>
    <link>https://bkellman.github.io/tags/rnaseq/</link>
    <description>Recent content in Rnaseq on Ben Kellman</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2017 Ben Kellman</copyright>
    <lastBuildDate>Wed, 20 Apr 2016 12:00:00 +0000</lastBuildDate>
    <atom:link href="/tags/rnaseq/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Examining the basis for between sample normalization</title>
      <link>https://bkellman.github.io/post/betweensamplenormalization/</link>
      <pubDate>Wed, 20 Apr 2016 12:00:00 +0000</pubDate>
      
      <guid>https://bkellman.github.io/post/betweensamplenormalization/</guid>
      <description>

&lt;h2 id=&#34;opinion-currently-under-review-as-of-8-7-2016&#34;&gt;&lt;em&gt;opinion currently under-review (as of 8/7/2016)&lt;/em&gt;&lt;/h2&gt;

&lt;p&gt;A friend pointed out to me recently that I should not be using FPKM for between sample comparisons and sent me &lt;a href=&#34;https://haroldpimentel.wordpress.com/2014/12/08/in-rna-seq-2-2-between-sample-normalization/&#34; target=&#34;_blank&#34;&gt;&lt;em&gt;this blog post&lt;/em&gt;&lt;/a&gt;. I had some thoughts about its validity and wanted to write them down.&lt;/p&gt;

&lt;p&gt;I believe the example used in this blogpost is not an reasonable. This prompted me to play a bit with the numbers and examine the robustness of FPKM in this respect.&lt;/p&gt;

&lt;p&gt;Clearly, FPKM (or library normalized counts) breaks down at 5 genes when 1 has a 20-fold increase in differential expression. That breakdown is indicated by the differential expression induced in all the other, stabely expressed, genes.
I&amp;rsquo;ve retooled the example above in general terms:
Normalized Count Treatment = Count_Gene_i / (Count_Gene_i x StableGenes + Count_Gene_Funky x FunkyGenes)&lt;/p&gt;

&lt;p&gt;$$NC_t = C_i / (C_i G_s + C_f G_f)$$
$$NC_t = 5/(5(5)+75(1)) = 0.05$$&lt;/p&gt;

&lt;p&gt;The concern is that this number diverges from the previous normalized count though it shouldn&amp;rsquo;t:
$$NC_c = 0.16 = 2/(2(5)+2(1))$$&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;As was pointed out in the blogplost, $NC_t \not= NC_c$ and that is incorrect.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;We can specify the expected Fold-Change for Stable genes as:
 $$E[FC] =  NC_t / NC_c $$
using &amp;ldquo;&amp;lsquo;&amp;rdquo; to denote the shift is observed expression, we can expand Fold change of a stable gene to:&lt;/p&gt;

&lt;p&gt;$$E[FC] = \frac{ C_i&amp;rsquo; / (C_i&amp;rsquo;  G_s + C_f&amp;rsquo;  G_f) }{ C_i / (C_i  G_s + C_f  G_f) }$$&lt;/p&gt;

&lt;p&gt;in the control condition $C_f = C_i$. So we can rewrite the above fold change as:&lt;/p&gt;

&lt;p&gt;$$ = \frac{ C_i&amp;rsquo; / (C_i&amp;rsquo; G_s + C_f&amp;rsquo; G_f) }{ C_i / (C_i G_s+G_f) } $$&lt;/p&gt;

&lt;p&gt;$$= \frac{ C_i&amp;rsquo; / (C_i&amp;rsquo; G_s + C_f&amp;rsquo; G_f) } { 1 / (G_s+G_f) } $$&lt;/p&gt;

&lt;p&gt;$$= \frac{ C_i&amp;rsquo; }{ (C_i&amp;rsquo; G_s + C_f&amp;rsquo; G_f) }  {  (G_s+G_f) }$$&lt;/p&gt;

&lt;p&gt;We can simplify by assuming that the funky genes will have an average of a 20-fold increase in expression. An average fold change of 20 is actually a good indication that there is something wrong with your design but I will get to that in a moment). Therefore $C_f&amp;rsquo; = 20C_i&amp;rsquo;$&lt;/p&gt;

&lt;p&gt;$$= \frac{ C_i&amp;rsquo; }{ (C_i&amp;rsquo; G_s + 20 C_i&amp;rsquo; G_f) }  {  (G_s+G_f) }$$&lt;/p&gt;

&lt;p&gt;$$= \frac{ 1 }{ ( G_s + 20 G_f) }  {  (G_s+G_f) }$$&lt;/p&gt;

&lt;p&gt;$$= \frac{  (G_s+G_f)}{( G_s + 20  G_f) } $$&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Actually, an expected or &amp;ldquo;average&amp;rdquo; value for fold change is 1.&lt;/strong&gt; There should be some upregulated, some down regulated, but on average, the expected fold-change of significantly differentially expressed genes is 1. That means that, on average, in a well-designed experiment: $E[C_f&amp;rsquo;] = 1C_i&amp;rsquo;$
$$E[FC]= \frac{  (G_s+G_f)}{( G_s + G_f) } = 1$$&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Once we correct the irregularly high fold change, the expected Fold-Change for Stable genes $E[FC]= 1$&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Let&amp;rsquo;s ignore the issue of the unrealistic fold-change for a moment&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;We should also consider that $G_f &amp;lt;&amp;lt;&amp;lt; G_s$. While $G_f$ is considered high if it comes close to 1,000 differentially expressed genes, $G_s$ in humans is typically between 20,000 and 150,000 depending on the annotation.
Therefore, we can say that there are 2-4 orders of magnitude seperating $G_f$ and $G_s$. Considering this, we can maintain the non-zero average fold change and approximate the above statement as:&lt;/p&gt;

&lt;p&gt;$$= \frac{  G_s+G_f}{ G_s + 20  G_f } $$
$$= \frac{  G_s+\epsilon}{ G_s + 20 \epsilon } $$
$$= \frac{  G_s}{ G_s  } $$&lt;/p&gt;

&lt;p&gt;Again, we find that with a realistic ratio of $G_f:G_s$, we expect a fold-change in stable genes close to 1 with a margin of error of 2-4 orders of magnitude.&lt;/p&gt;

&lt;p&gt;The problem with this example is it assumes a poorly designed or poorly controlled experiment where the average differential expression is 20-fold. If we, remove this mistake from the example, stable gene differential expression goes to 1 which is correct.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
